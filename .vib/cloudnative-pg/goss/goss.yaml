# Copyright Broadcom, Inc. All Rights Reserved.
# SPDX-License-Identifier: APACHE-2.0

http:
  https://cnpg-webhook-service:{{ .Vars.operator.service.ports.webhook }}/readyz:
    status: 200
    allow-insecure: true
  http://cloudnative-pg-operator-metrics:{{ .Vars.operator.metrics.service.ports.metrics }}/metrics:
    status: 200
    body:
      - /controller_runtime_reconcile_time_seconds_bucket/
  https://cloudnative-pg-plugin-barman-cloud-metrics:{{ .Vars.pluginBarmanCloud.metrics.service.ports.metrics }}/metrics:
    status: 200
    allow-insecure: true
    body:
      - /controller_runtime_reconcile_time_seconds_bucket/
# Ports hardcoded in the operator
addr:
  tcp://vib-cluster-example-r:5432:
    reachable: true
  tcp://vib-cluster-example-rw:5432:
    reachable: true
  tcp://vib-cluster-example-ro:5432:
    reachable: true
command:
  check-backup-status:
    exec: kubectl get backups
    exit-status: 0
    stdout:
      - /backup-example.*completed/
